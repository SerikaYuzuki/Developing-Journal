---
title: "組織生成論"
author: "Serika Yuzuki"
date: "2024-4-8"
categories: [University, 2024]
image: "images/thumbnail.png"
bibliography: ../../../bibliography.bib
---

$$
\require{physics}
$$

# ノート

## 核生成

液相中に古層の角が生成する時、自由エネルギー変化は次のように表される。

$$
\Delta G = -V_s \Delta G_v + A \sigma_{SL}
$$

ここで、$V_s$ は核の体積、$\Delta G_v$ は核の体積の自由エネルギー、$A$ は核の表面積、$\sigma_{SL}$ は核の界面エネルギーである。

熱力学的駆動力は過冷却の温度差に比例する。

$$
\Delta G = \frac{\Delta H_f\Delta T}{T_m}
$$

$\Delta T$ は過冷却温度差、 $T_m$ は融点、$\Delta H_f$ は融解エンタルピーである。

これの導出には、次のようにする。 $\Delta G$ とは個体と液体の自由エネルギー差である。

$$
\begin{align*}
\Delta G &= \Delta H_f - T\Delta S\\
0 &= \Delta H_f - T_m\Delta S\\
\Delta S &= \frac{\Delta H_f}{T_m} \\
\Delta G &= \Delta H_f - T\frac{\Delta H_f}{T_m} \\
&= \frac{T_m - T}{T_m}\Delta H_f\\
&= \frac{\Delta T}{T_m}\Delta H_f
\end{align*}
$$

ここで、核生成の自由エネルギーを考えると、

$$
\begin{aligned}
\Delta G &= -V_s \Delta G_v + A \sigma_{SL} \\
&= -\frac{4}{3}\pi r^3 \Delta G_v + 4\pi r^2 \sigma_{SL} \\
\end{aligned}
$$

ここで、$r$ は核の半径である。$r^3$ を考えれば、一度核ができればどんどん大きくなった方が安定する。ここで、

$$
\pdv{\Delta G}{r} = 0
$$

となるような $r$ を臨界半径と呼ぶ。これを解くと、

$$
r^* = \frac{2\pi \sigma_{SL}}{\Delta G_v}
$$

これを代入すると、

$$
\Delta G^* = \frac{16\pi \sigma_{SL}^3}{3\Delta G_v^2}
$$

これにさらに

$$
\Delta G_v = \frac{\Delta H_m \Delta T}{T_m}
$$

を代入すると、

$$
\Delta G^* = \frac{16\pi \sigma_{SL}^3 T_m^2}{3\Delta H_m^2 } \frac{1}{\Delta T^2}
$$

となり、過冷却状態だと、臨界半径における自由エネルギーはその過冷却温度の二乗の逆数に比例する。

以上の議論を別方向からもできて、界面生成に必要なエネルギーは次のように表される。

$$
\begin{aligned}
E_{Int} &= 4\pi r^2 \sigma_{SL} \\
\dv{E}{V} &= \frac{2\sigma_{SL}}{r}\\
\frac{\Delta G}{\Delta V} &= \Delta G_v + \frac{2\sigma_{SL}}{r^*} = 0 \\
r^* &= \frac{2\sigma_{SL}}{\Delta G_v}
\end{aligned}
$$


## 表面エネルギー

同一原子群に関しては、次のような式が成り立つ。

$$
\sigma_{AV} = \frac{Zm_1}{\omega} \frac{\epsilon_{AA}}{2}
$$

ここで、 $Z$ は配位数 $m_1$ は Broken bondの割合の数、 $\omega$ は原子一個あたりの面積で、 $\epsilon_{AA}$ は原子間の結合エネルギーである。

また、表面エネルギーは昇華熱に比例する。

次に、別々の原子群に関しては、次のような式が成り立つ。

$$
\sigma_{AB} = \frac{Zm_1}{\omega} \left\{ \epsilon_{AB} - \frac{\epsilon_{AA}+\epsilon_{BB}}{2} \right\}
$$

## 熱力学的駆動力 {#sec-thermo-driving-force}

熱力学的駆動力は、液体→固体へ相変化が起こるときのモル体積あたりの自由エネルギー差である。

$$
\Delta G_v = \frac{\Delta G_m}{V_m}
$$

ここで、$\Delta G_m$ が負であれば、固体化へ自発的に進むことになる。

では、融点付近での動きを見てみることにする。まず、融点においては、固体と液体が平衡にあるので、

$$
\Delta G_v = 0
$$

これが融点の定義でもある。なので、

$$
\Delta S_{\mathrm{fus}} = \frac{\Delta H_{\mathrm{fus}}}{T_m}
$$

となるのだが、これってのは融点付近の $\Delta S$ 自体の近似値として使用可能。なので、

$$
\Delta G_v = \frac{\Delta H_{\mathrm{fus}}}{V_m} \frac{T_m - T}{T_m} = \frac{\Delta H_{\mathrm{fus}}}{V_m} \frac{\Delta T}{T_m}
$$

となる。で、ここまでの議論でかなり重要な話だが、 $\Delta H_{\mathrm{fus}}$ の符号は基本的に負だ。そりゃあ凝固してるんだから。ただし！！　これが融解エンタルピー、つまり、凝固に伴うエンタルピー変化を逆から見て符号を変えたものの時は、マイナスをつけよう。

講義資料では深く触れられていなかったため、まじで注意！！

## 均質核生成 {#sec-homogeneous-nucleation}

均質核生成は、核生成の熱力学的駆動力が負であることが必要である。

TODO: ここに均質核生成の詳細な議論を書く。






# 過去問

<!-- 
::: {.callout-note collapse="true"}
##### 理論

This is an example of a callout with a title.
:::

::: {.callout-tip collapse="true"}
##### 解答

This is an example of a callout with a title.
::: 
-->

## 2024年度

### 問1

```{python}
import numpy as np
import numpy as np
import matplotlib.pyplot as plt

# --- ヘルパー関数 ---
def bezier_curve(P, Q, offset_y, t):
    """2次ベジェ曲線を返す"""
    mid = (P + Q) / 2
    C = mid + np.array([0, offset_y])
    return np.outer((1 - t)**2, P) + np.outer(2*(1 - t)*t, C) + np.outer(t**2, Q)

def line_interpolate(P, Q, x=None, y=None):
    """
    直線上の補間
    x 指定 → y,  y 指定 → x
    """
    x0, y0 = P
    x1, y1 = Q
    if x is not None and y is None:
        return y0 + (y1 - y0) / (x1 - x0) * (x - x0)
    if y is not None and x is None:
        return x0 + (x1 - x0) / (y1 - y0) * (y - y0)
    raise ValueError("x か y のどちらか片方を指定")

# --- 主要点の設定 ---
A       = np.array([  1,  300])
point0  = np.array([ 10,  800])
point1  = np.array([  0, 1180])
point2  = np.array([ 60,  800])
point3  = np.array([100, 1080])
point4  = np.array([ 90,  800])
B       = np.array([ 98,  300])

# ベジェ曲線の定義
segments = [
    (A,      point0, 100),
    (point0, point1, 100),
    (point1, point2, 150),
    (point2, point3, 100),
    (point3, point4, 100),
    (point4, B,      100),
]
t = np.linspace(0, 1, 300)
curves = [bezier_curve(P, Q, off, t) for P, Q, off in segments]

# --- プロット ---
fig, ax = plt.subplots(figsize=(8, 6))
ax.set_xlim(0, 100)
ax.set_ylim(300, 1300)
ax.set_xlabel('B (wt%)')
ax.set_ylabel('Temperature (°C)')
ax.set_title('Combined Phase Diagram')

# ベジェ曲線描画
for curve in curves:
    ax.plot(curve[:,0], curve[:,1], color='black', lw=2)

# point0-point4 の直線
ax.plot([point0[0], point4[0]], [point0[1], point4[1]], 
        linestyle='-', color='black', lw=1)

# 水平線 y=900
y_h = 900
ax.axhline(y=y_h, linestyle='--', color='gray')

# y=900 とベジェ曲線の交点
for curve in curves:
    xs, ys = curve[:,0], curve[:,1]
    idx = np.where((ys[:-1]-y_h)*(ys[1:]-y_h) <= 0)[0]
    for i in idx:
        x0, y0 = xs[i], ys[i]
        x1, y1 = xs[i+1], ys[i+1]
        x_cross = x0 + (y_h-y0)/(y1-y0)*(x1-x0)
        ax.scatter(x_cross, y_h, color='red')
        ax.annotate(f'({x_cross:.1f}, {y_h})', (x_cross, y_h),
                    textcoords='offset points', xytext=(5,5))

# 垂直線 x=20, 60
x_lines = [20, 60]
for x_v in x_lines:
    ax.axvline(x=x_v, linestyle='--', color='gray')
    # 交点計算
    for curve in curves:
        xs, ys = curve[:,0], curve[:,1]
        idx = np.where((xs[:-1]-x_v)*(xs[1:]-x_v) <= 0)[0]
        for i in idx:
            x0, y0 = xs[i], ys[i]
            x1, y1 = xs[i+1], ys[i+1]
            # 線形補間
            y_cross = y0 + (y1-y0)/(x1-x0)*(x_v-x0)
            ax.scatter(x_v, y_cross, color='blue')
            ax.annotate(f'({x_v}, {y_cross:.1f})', (x_v, y_cross),
                        textcoords='offset points', xytext=(5,-10))

plt.tight_layout()
plt.show()

```

(1) A–20 wt % B 合金を 1200 °C で長時間保持し、その後十分ゆっくりと冷却した。  
    1. 固相の晶出が始まる温度  
    2. 液相が完全になくなる温度  
    3. 最終的に得られる組織中の共晶組織の割合  

(2) 60 wt % B 合金を 1200 °C で長時間保持し、その後ゆっくりと冷却した。 時間に対する温度変化を表すグラフを模式的に描け。

(3) A–20 wt % B 合金と A–60 wt % B 合金の冷却過程におけるそれぞれの組織の模式図を、以下の各温度について描け。  
    - 1000 °C  
    - 800 °C 直上  
    - 800 °C 直下  

(4) 900 °C における L、α、β 各相の自由エネルギー曲線を、  
    - 相平衡を表す共通接線と共に描け。  
    - 相図中の組成 P、Q、R、S を自由エネルギー曲線図中に示せ。

::: {.callout-note collapse="true"}
##### 理論

ここらの理論については、@newglass2014no113vol29 や解答で載せた資料を参考にすれば非常によく理解できるはず。というか、試験内容のうち、京商などに関連する内容はほぼ全てこれを読めばなんとかなるはず。

あまりこういうことは言いたくないけど、完全上位互換な資料が山ほど世の中で転がっている中で、これらの活用をしないのは仕方なきにしても、あまつさえ自身の講義資料すら公開しないような講義の仕方をする講師の方たちというのはいかがなものかね。それに、非常に質の良い資料を商業化するためにクローズドソースにすることを選択するのは仕方なきにしても、いつかインターネットの肥やしになるくらいならば、いっそGitHubなどに公開して欲しいものだ。

:::

::: {.callout-tip collapse="true"}
##### 解答

(1) 晶出は $1120 {}^\circ\text{C}$ で始まる。それからどんどん晶出が続いて $800 {}^\circ\text{C}$ で液相がなくなる。最終的に得られる共晶組織の割合は、$10/50 = 20\%$ である。このうちの $\alpha$ 相の割合は、$20\% \times 30 / 80 = 7.5\%$ であり、$\beta$ 相の割合は、$20\% \times 50 / 80 = 12.5\%$ である。これについては、ギリギリまで液相だったものが共晶として析出して、その割合がテコの原理で 60% のところを見ることになる。

(2) このダイアグラムを $\LaTeX$ などで書くのは相当面倒なので、 @材料学入門 から引用した図を以下に示す。

![冷却過程における温度変化](images/%E7%B5%84%E7%B9%94%E7%94%9F%E6%88%90%E8%AB%96/image1.png)

(3) このダイアグラムを $\LaTeX$ などで書くのは相当面倒なので、 @溶接学会no77vol6 から引用した図を以下に示す。

![共晶組織の冷却過程](images/%E7%B5%84%E7%B9%94%E7%94%9F%E6%88%90%E8%AB%96/image0.png)

(4) 四苦八苦して動かせるグラフをplotlyで書いてやろうかと思ってたのだが、すっごく綺麗な資料があったので、@PhaseDiagram を参考してほしい。

![自由エネルギー曲線](images/%E7%B5%84%E7%B9%94%E7%94%9F%E6%88%90%E8%AB%96/image2.png)

::: 

### 問2

A. ある純金属の融解エンタルピー（$\Delta H_{\mathrm{ml}}$）は $10 \mathrm{kJ \cdot mol^{-1}}$、融点は $T_m = 1500 \mathrm{K}$ である。また、モル体積は $V_m = 6 \times 10^{-6} \mathrm{m^3 \cdot mol^{-1}}$ とする。

1. この金属の融解エントロピー $\Delta S_{\mathrm{ml}}$ を求めよ。  
2. この金属を完全に融解した後、融点より 100 K 低い温度（$T = T_m - 100 \mathrm{K}$）に冷却・保持したとき、固体生成の熱力学的駆動力 $\Delta G_{\mathrm{v}}$ を求めよ。  
3. この金属の固液界面エネルギーを $\gamma = 0.18 \mathrm{J \cdot m^{-2}}$ とする。 2.の条件下で球状の固体核が液中に生成するときの臨界半径 $r^*$ を求めよ。  

B. 多結晶固体中の核生成はしばしば粒界で起こる。この理由を約100字程度で説明せよ。

::: {.callout-note collapse="true"}
##### 理論

1. 等温、等圧過程なので、ギブスエネルギーを考えればいい。

$$
\Delta G = \Delta H - T\Delta S
$$

TODO：いずれ熱力学ポテンシャルについての総合的な記事を書く。

2. 熱力学的駆動力は、@sec-thermo-driving-force で述べたように、
$$
\Delta G_v = \frac{\Delta H_{\mathrm{fus}}}{V_m} \frac{\Delta T}{T_m}
$$
ただし、注意として、 $\Delta H_{\mathrm{ml}} = - \Delta H_{\mathrm{fus}}$ である。

3. 臨界半径などの話は @sec-homogeneous-nucleation を参照。
$$
r^* = \frac{2\sigma_{SL}}{\Delta G_v}
$$
ここで、$\Delta G_v$ は熱力学的駆動力、$\sigma_{SL}$ は核の界面エネルギーである。




:::

::: {.callout-tip collapse="true"}
##### 解答
A.
    1. 固体と液体が並行状態にあるので、
$$
\begin{aligned}
\Delta G_{\mathrm{ml}} &= \Delta H_{\mathrm{ml}} - T\Delta S_{\mathrm{ml}} = 0 \\
\Delta S_{\mathrm{ml}} &= \frac{\Delta H_{\mathrm{ml}}}{T_m} = \frac{10 \mathrm{kJ \cdot mol^{-1}}}{1500 \mathrm{K}} = 6.67 \mathrm{kJ \cdot mol^{-1} \cdot K^{-1}}
\end{aligned}
$$

    2. 
$\Delta T = -100 \mathrm{K}$ なので、
$$
\Delta G_v = - \frac{10 \mathrm{kJ \cdot mol^{-1}}}{6 \times 10^{-6} \mathrm{m^3 \cdot mol^{-1}}} \frac{100 \mathrm{K}}{1500 \mathrm{K}} = -1.11 \times 10^{5} \mathrm{kJ \cdot m^{-3}}
$$
```{python}
import numpy as np

# 定数
T_m = 1500 # K
V_m = 6e-6 # m^3/mol
H_ml = 10 # kJ/mol

# 計算
T = T_m - 100
G_v = - H_ml / V_m * (T_m - T) / T_m

print(f"熱力学的駆動力: {G_v:.2f} kJ/m^3")
```

    3. 式は以下の通り。
$$
r^* = \frac{2 \times 0.18 \mathrm{J \cdot m^{-2}}}{-1.11 \times 10^{5} \mathrm{kJ \cdot m^{-3}}} = 3.2 \times 10^{-9} \mathrm{m}
$$
```{python}
import numpy as np

# 定数
sigma_SL = 0.18 # J/m^2
G_v = -1.11e8 # J/m^3

# 計算
r_star = 2 * sigma_SL / G_v
print(f"臨界半径: {r_star:.2e} m")
```
B. 粒界は格子歪みや欠陥が集中して界面エネルギーが高く、その結果、核生成に必要な自由エネルギー障壁が低下し、かつ原子拡散が促進されるため、多結晶中ではまず粒界で核生成が起こりやすい。  



::: 
